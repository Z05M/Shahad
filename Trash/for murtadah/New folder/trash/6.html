<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <title>For Shahad</title>
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500&family=Great+Vibes&display=swap"
    rel="stylesheet" />
  <style>
    :root {
      --bg1: #fbe8ff;
      --bg2: #ffd9e3;
      --bg3: #d9e3ff;
      --accent-strong: #c855a6;
      --accent-soft: #6b4dd8;
      --text-main: #4a3058;
      --gold: #ffd700;
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: "Poppins", sans-serif;
      min-height: 100vh;
      overflow: hidden;
      display: flex;
      align-items: center;
      justify-content: center;
      /* نحتفظ بالمنظور لحركة الدخول والخروج فقط */
      perspective: 1200px;
      /* الخلفية الأصلية */
      background: radial-gradient(circle at 0% 0%, rgba(255, 255, 255, 0.9), transparent 60%),
                  radial-gradient(circle at 100% 100%, rgba(255, 255, 255, 0.9), transparent 60%),
                  linear-gradient(135deg, var(--bg1), var(--bg2), var(--bg3));
      background-size: 200% 200%;
      animation: bgShift 18s ease-in-out infinite alternate;
      transition: background 2s ease;
      cursor: auto;
    }

    /* الوضع السينمائي عند الضغط */
    body.cinematic-mode {
      background: radial-gradient(circle at 50% 50%, #1a0b2e, #000000) !important;
    }

    @keyframes bgShift {
      0% { background-position: 0% 0%; }
      100% { background-position: 100% 100%; }
    }

    /* --- مقدمة وعناصر جمالية --- */
    .intro-fog {
      position: fixed; inset: 0; z-index: 800;
      background: radial-gradient(circle at 50% 30%, rgba(255, 255, 255, 1), rgba(255, 255, 255, 0.85) 40%, rgba(255, 255, 255, 0.4) 70%, transparent 100%);
      backdrop-filter: blur(18px);
      animation: fogFade 2.6s ease-out 1s forwards;
      pointer-events: none;
    }
    @keyframes fogFade { 0% { opacity: 1; } 100% { opacity: 0; visibility: hidden; } }

    .floating-letters {
      position: fixed; left: 50%; top: 50%; transform: translate(-50%, -50%);
      display: flex; gap: 10px;
      font-family: "Poppins", sans-serif; font-size: 30px; letter-spacing: 0.25em;
      text-transform: uppercase; color: var(--accent-strong);
      z-index: 850; pointer-events: none;
    }
    .floating-letters span { opacity: 0; animation: floatAssemble 2.1s ease-out forwards; }
    .floating-letters span:nth-child(1) { animation-delay: 1.1s; }
    .floating-letters span:nth-child(2) { animation-delay: 1.16s; }
    .floating-letters span:nth-child(3) { animation-delay: 1.22s; }
    .floating-letters span:nth-child(4) { animation-delay: 1.28s; }
    .floating-letters span:nth-child(5) { animation-delay: 1.34s; }
    .floating-letters span:nth-child(6) { animation-delay: 1.40s; }
    
    @keyframes floatAssemble {
      0% { opacity: 0; transform: translate3d(-18px, 18px, 0); }
      30% { opacity: 1; }
      100% { opacity: 0; transform: translate3d(0, -8px, 0); }
    }

    /* --- البطاقة (ثابتة بدون دوران) --- */
    .card-container {
      position: relative; z-index: 10; width: 100%; height: 100vh;
      display: flex; align-items: center; justify-content: center;
      transform-style: preserve-3d;
    }

    .card {
      position: relative; width: 90%; max-width: 520px;
      padding: 40px 30px 90px; /* مساحة للزر */
      border-radius: 28px;
      background: linear-gradient(135deg, rgba(255, 255, 255, 0.7), rgba(255, 255, 255, 0.3));
      border: 1px solid rgba(255, 255, 255, 0.9);
      box-shadow: 0 20px 50px rgba(0,0,0,0.05), 0 0 0 1px rgba(255,255,255,0.4) inset;
      backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);
      text-align: center;
      
      /* الحالة الابتدائية قبل الظهور */
      opacity: 0; 
      transform: translateY(28px) scale(0.96);
      
      transition: opacity 1s ease-out, transform 1s ease-out;
      transform-style: preserve-3d;
    }

    /* الحالة الظاهرة: ثابتة تماماً في المنتصف */
    .card.show-card { 
      opacity: 1; 
      transform: translateY(0) scale(1) !important; /* !important لمنع أي تأثير خارجي */
    }

    /* تأثير الانطلاق (Warp) عند النهاية */
    .card.warp-out {
      animation: warpZoom 1.5s cubic-bezier(0.7, 0, 0.3, 1) forwards;
      pointer-events: none;
    }
    @keyframes warpZoom {
      0% { transform: scale(1) translateZ(0); opacity: 1; }
      40% { opacity: 0.9; }
      100% { transform: scale(4) translateZ(800px); opacity: 0; }
    }

    .card::before {
      content: ""; position: absolute; top: 0; left: 0; width: 100%; height: 100%;
      border-radius: 28px;
      background: linear-gradient(120deg, transparent 30%, rgba(255,255,255,0.6) 50%, transparent 70%);
      transform: translateX(-100%); transition: 0.5s; pointer-events: none; z-index: 10;
    }
    .card.show-card::before { animation: cardSweep 2.5s ease-out 1s forwards; }
    @keyframes cardSweep {
      0% { transform: translateX(-140%) skewX(-12deg); opacity: 0; }
      100% { transform: translateX(140%) skewX(-12deg); opacity: 0; }
    }

    .halo-ring {
      position: absolute; inset: 14px; border-radius: 22px;
      border: 1px solid rgba(255, 200, 240, 0.6);
      pointer-events: none; opacity: 0.6; transform: translateZ(20px);
    }

    .script-title {
      font-family: "Great Vibes", cursive; font-size: 36px;
      color: var(--accent-strong); margin-bottom: 8px;
      transform: translateZ(40px); text-shadow: 0 4px 10px rgba(200, 85, 166, 0.15);
      pointer-events: none;
    }
    .for {
      font-size: 12px; color: var(--text-soft); margin-bottom: 6px;
      letter-spacing: 0.18em; text-transform: uppercase;
      transform: translateZ(30px); pointer-events: none;
    }
    .name {
      font-size: 24px; letter-spacing: 0.22em; text-transform: uppercase;
      color: var(--accent-strong); transform: translateZ(50px); font-weight: 600;
      background: linear-gradient(45deg, var(--accent-strong), var(--accent-soft));
      -webkit-background-clip: text; -webkit-text-fill-color: transparent;
      display: inline-block; pointer-events: none;
    }
    .underline {
      width: 120px; height: 2px; margin: 20px auto 16px;
      background: linear-gradient(90deg, transparent, var(--accent-strong), transparent);
      opacity: 0.8; transform: translateZ(25px); pointer-events: none;
    }
    .tiny-note {
      font-size: 13px; color: var(--text-main); opacity: 0.9;
      white-space: pre-line; line-height: 1.8; max-width: 28em;
      margin: 10px auto 0; transform: translateZ(35px);
      min-height: 120px; pointer-events: none;
    }

    /* --- الزر (مصحح ومضمون النقر) --- */
    .wish-btn {
      position: absolute;
      bottom: 40px; left: 50%;
      /* فصل تام */
      transform: translateX(-50%) translateZ(80px);
      
      background: transparent;
      border: 1px solid var(--accent-strong);
      color: var(--accent-strong);
      padding: 12px 35px;
      border-radius: 50px;
      font-family: "Poppins", sans-serif;
      font-size: 14px; letter-spacing: 0.1em; text-transform: uppercase;
      cursor: pointer !important;
      z-index: 9999; /* أعلى طبقة */
      
      opacity: 0; pointer-events: none;
      transition: opacity 3s ease, transform 3s cubic-bezier(0.2, 0.8, 0.2, 1), background 0.3s, color 0.3s;
    }

    .wish-btn.show-btn {
      opacity: 1; pointer-events: auto;
      transform: translateX(-50%) translateZ(80px);
    }

    .wish-btn:hover {
      background: var(--accent-strong); color: white;
      box-shadow: 0 0 25px rgba(200, 85, 166, 0.6);
      transform: translateX(-50%) translateZ(90px) scale(1.05);
    }

    /* --- النص النهائي السينمائي --- */
    .final-container {
      position: fixed; inset: 0;
      display: flex; flex-direction: column; align-items: center; justify-content: center;
      z-index: 50; text-align: center; pointer-events: none;
    }
    .final-text {
      font-family: "Great Vibes", cursive; font-size: 50px; color: white;
      text-shadow: 0 0 20px rgba(255, 215, 0, 0.6);
      opacity: 0; transform: translateY(30px);
      transition: all 1.5s ease;
    }
    .final-text.visible { opacity: 1; transform: translateY(0); }
    
    .shimmer {
      background: linear-gradient(to right, #bf953f, #fcf6ba, #b38728, #fbf5b7);
      -webkit-background-clip: text; background-clip: text; color: transparent;
      background-size: 200% auto; animation: shine 3s linear infinite;
    }
    @keyframes shine { to { background-position: 200% center; } }

    /* الكانفاس */
    canvas#world { position: fixed; inset: 0; z-index: 1; pointer-events: none; }

    @media (max-width: 480px) {
      .card { padding: 30px 20px 80px; width: 90%; }
      .final-text { font-size: 38px; }
    }
  </style>
</head>

<body>
  <div class="intro-fog"></div>
  
  <div class="floating-letters">
    <span>S</span><span>H</span><span>A</span><span>H</span><span>A</span><span>D</span>
  </div>

  <canvas id="world"></canvas>

  <div class="card-container" id="cardContainer">
    <div class="card" id="card">
      <div class="halo-ring"></div>
      <div class="script-title">Happy New Year</div>
      <div class="for">FOR</div>
      <div class="name">SHAHAD</div>
      <div class="underline"></div>
      <div class="tiny-note" id="typewriterText"></div>

      <button class="wish-btn" id="wishBtn" onclick="makeAWish()">Make a Wish ✨</button>
    </div>
  </div>

  <script>
    /* --- 1. إعدادات الكانفاس والجزيئات --- */
    const canvas = document.getElementById("world");
    const ctx = canvas.getContext("2d");
    let w, h, particles = [];
    let mode = "intro"; 

    function resize() { w = canvas.width = window.innerWidth; h = canvas.height = window.innerHeight; }
    window.addEventListener("resize", resize); resize();

    function randomColor() {
      const c = ["#ffc0cb", "#e6e6fa", "#ffffff"];
      return c[Math.floor(Math.random() * c.length)];
    }

    class Particle {
      constructor(type) {
        this.type = type;
        this.init();
      }
      init() {
        if (this.type === 'intro') {
          this.x = Math.random() * w; this.y = h;
          this.vx = (Math.random() - 0.5) * 2;
          this.vy = -(Math.random() * 3 + 2);
          this.alpha = 1; this.color = randomColor();
          this.size = Math.random() * 2;
          this.decay = 0.01;
        } else { // vortex
          this.x = w/2; this.y = h/2;
          const angle = Math.random() * Math.PI * 2;
          const speed = Math.random() * 4 + 1;
          this.vx = Math.cos(angle) * speed;
          this.vy = Math.sin(angle) * speed;
          this.life = 150; this.maxLife = 150;
          this.color = "#ffd700"; // Gold
          this.size = Math.random() * 2.5;
        }
      }
      update() {
        if (this.type === 'intro') {
          this.x += this.vx; this.y += this.vy; this.alpha -= this.decay;
        } else {
          this.x += this.vx; this.y += this.vy;
          this.vx *= 0.98; this.vy *= 0.98; // احتكاك
          this.life--; this.alpha = this.life / this.maxLife;
        }
      }
      draw() {
        ctx.globalAlpha = Math.max(0, this.alpha);
        ctx.fillStyle = this.color;
        ctx.beginPath(); ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2); ctx.fill();
        ctx.globalAlpha = 1;
      }
    }

    function animate() {
      ctx.clearRect(0, 0, w, h);
      
      // إضافة جزيئات
      if (mode === 'intro' && Math.random() < 0.1) particles.push(new Particle('intro'));
      if (mode === 'vortex') {
        for(let i=0; i<8; i++) particles.push(new Particle('vortex'));
      }

      for (let i = particles.length - 1; i >= 0; i--) {
        particles[i].update();
        particles[i].draw();
        if (particles[i].alpha <= 0) particles.splice(i, 1);
      }
      requestAnimationFrame(animate);
    }
    animate();

    /* --- 2. الكتابة والبطاقة --- */
    const fullMessage = `Shahad, happy New Year.
    I wish you a year filled with peace and joy,
    and moments that place a gentle smile on your heart.
    May this new year be kinder and more beautiful for you,
    bringing everything you truly deserve…
    and may the days ahead carry a purity that reflects your spirit.`;
    
    const noteElement = document.getElementById('typewriterText');
    let charIndex = 0;

    function typeWriter() {
      if (charIndex < fullMessage.length) {
        noteElement.textContent += fullMessage.charAt(charIndex);
        charIndex++;
        setTimeout(typeWriter, 35);
      } else {
        // انتهت الكتابة: إظهار الزر الفخم
        setTimeout(() => {
          document.getElementById('wishBtn').classList.add('show-btn');
        }, 500);
      }
    }

    window.addEventListener("load", () => {
      const card = document.getElementById("card");
      
      setTimeout(() => {
        card.classList.add("show-card");
        setTimeout(typeWriter, 1200);
        // *تم حذف كود حركة الماوس والدوران ليبقى الكارت ثابتاً*
      }, 3300);
    });

    /* --- 3. حدث الأمنية المبهر (Cinematic Finale) --- */
    function makeAWish() {
      const card = document.getElementById('card');
      const btn = document.getElementById('wishBtn');
      
      // 1. تجميد وإخفاء الزر
      btn.style.pointerEvents = 'none';
      btn.style.opacity = '0';
      
      // 2. تفعيل الانطلاق والظلام
      card.classList.add('warp-out');
      document.body.classList.add('cinematic-mode');
      
      // 3. تغيير الجزيئات للذهب
      mode = 'vortex';
      particles = []; // تفريغ القديم

      // 4. إظهار رسالة النهاية
      setTimeout(() => {
        createFinalMessage();
      }, 1200);
    }

    function createFinalMessage() {
      const div = document.createElement('div');
      div.className = 'final-container';
      
      const h1 = document.createElement('h1');
      h1.className = 'final-text shimmer';
      h1.innerHTML = "Happy New Year<br>Shahad ✨";
      
      div.appendChild(h1);
      document.body.appendChild(div);
      
      setTimeout(() => h1.classList.add('visible'), 100);
    }
  </script>
</body>
</html>