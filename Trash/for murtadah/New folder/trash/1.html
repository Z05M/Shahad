<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <title>For Shahad</title>
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500&family=Great+Vibes&display=swap"
    rel="stylesheet" />
  <style>
    :root {
      --bg1: #fbe8ff;
      --bg2: #ffd9e3;
      --bg3: #d9e3ff;
      --card-bg: rgba(255, 255, 255, 0.65);
      --card-border: rgba(255, 255, 255, 0.9);
      --accent-strong: #c855a6;
      --accent-soft: #6b4dd8;
      --text-main: #4a3058;
      --text-soft: #9b6c9e;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: "Poppins", sans-serif;
      min-height: 100vh;
      overflow: hidden;
      display: flex;
      align-items: center;
      justify-content: center;
      perspective: 1200px;
      background:
        radial-gradient(circle at 0% 0%, rgba(255, 255, 255, 0.9), transparent 60%),
        radial-gradient(circle at 100% 100%, rgba(255, 255, 255, 0.9), transparent 60%),
        linear-gradient(135deg, var(--bg1), var(--bg2), var(--bg3));
      background-size: 200% 200%;
      animation: bgShift 18s ease-in-out infinite alternate;
      /* رجّعنا الماوس طبيعي */
      cursor: auto;
    }

    @keyframes bgShift {
      0% {
        background-position: 0% 0%;
      }

      50% {
        background-position: 60% 100%;
      }

      100% {
        background-position: 100% 0%;
      }
    }

    .intro-fog {
      position: fixed;
      inset: 0;
      z-index: 900;
      background: radial-gradient(circle at 50% 30%, rgba(255, 255, 255, 1), rgba(255, 255, 255, 0.85) 40%, rgba(255, 255, 255, 0.4) 70%, transparent 100%);
      backdrop-filter: blur(18px);
      animation: fogFade 2.6s ease-out 1s forwards;
      pointer-events: none;
    }

    @keyframes fogFade {
      0% {
        opacity: 1;
      }

      40% {
        opacity: 0.9;
      }

      80% {
        opacity: 0.3;
      }

      100% {
        opacity: 0;
        visibility: hidden;
      }
    }

    .intro-line {
      position: fixed;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
      height: 1.5px;
      width: 0;
      background: linear-gradient(90deg,
          transparent,
          rgba(255, 255, 255, 0.9),
          rgba(255, 255, 255, 1),
          rgba(255, 255, 255, 0.9),
          transparent);
      box-shadow: 0 0 14px rgba(255, 255, 255, 0.9),
        0 0 28px rgba(255, 200, 240, 0.8);
      z-index: 950;
      animation: introLine 2.1s ease-out 1s forwards;
      pointer-events: none;
    }

    @keyframes introLine {
      0% {
        width: 0;
        opacity: 0;
      }

      25% {
        width: 120px;
        opacity: 1;
      }

      60% {
        width: 320px;
        opacity: 1;
      }

      100% {
        width: 420px;
        opacity: 0;
      }
    }

    .floating-letters {
      position: fixed;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
      display: flex;
      gap: 8px;
      font-family: "Poppins", sans-serif;
      font-size: 30px;
      letter-spacing: 0.25em;
      text-transform: uppercase;
      color: var(--accent-strong);
      z-index: 930;
      pointer-events: none;
    }

    .floating-letters span {
      opacity: 0;
      animation: floatAssemble 2.1s ease-out forwards;
    }

    .floating-letters span:nth-child(1) {
      animation-delay: 1.1s;
    }

    .floating-letters span:nth-child(2) {
      animation-delay: 1.16s;
    }

    .floating-letters span:nth-child(3) {
      animation-delay: 1.22s;
    }

    .floating-letters span:nth-child(4) {
      animation-delay: 1.28s;
    }

    .floating-letters span:nth-child(5) {
      animation-delay: 1.34s;
    }

    .floating-letters span:nth-child(6) {
      animation-delay: 1.40s;
    }

    @keyframes floatAssemble {
      0% {
        opacity: 0;
        transform: translate3d(-18px, 18px, 0) scale(0.9);
      }

      30% {
        opacity: 1;
      }

      70% {
        opacity: 1;
        transform: translate3d(0, 0, 0) scale(1);
      }

      100% {
        opacity: 0;
        transform: translate3d(0, -8px, 0) scale(0.98);
      }
    }

    .card-container {
      position: relative;
      z-index: 3;
      width: 100%;
      height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      transform-style: preserve-3d;
    }

    .card {
      position: relative;
      width: 90%;
      max-width: 520px;
      height: 600px;
      padding: 40px 30px;
      border-radius: 28px;
      background: linear-gradient(135deg,
          rgba(255, 255, 255, 0.7),
          rgba(255, 255, 255, 0.3));
      border: 1px solid rgba(255, 255, 255, 0.9);
      box-shadow: 0 20px 50px rgba(0, 0, 0, 0.05),
        0 0 0 1px rgba(255, 255, 255, 0.4) inset;
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      text-align: center;
      opacity: 0;
      transform: translateY(28px) scale(0.96);
      transition: opacity 1s ease-out, transform 1s ease-out;
      overflow: visible;
      transform-style: preserve-3d;
    }

    .card.show-card {
      opacity: 1;
      transform: translateY(0) scale(1);
    }

    .card::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      border-radius: 28px;
      background: linear-gradient(120deg,
          transparent 30%,
          rgba(255, 255, 255, 0.6) 50%,
          transparent 70%);
      transform: translateX(-100%);
      transition: 0.5s;
      pointer-events: none;
      z-index: 10;
    }

    .card.show-card::before {
      animation: cardSweep 2.5s ease-out 1s forwards;
    }

    @keyframes cardSweep {
      0% {
        transform: translateX(-140%) skewX(-12deg);
        opacity: 0;
      }

      10% {
        opacity: 1;
      }

      100% {
        transform: translateX(140%) skewX(-12deg);
        opacity: 0;
      }
    }

    .halo-ring {
      position: absolute;
      inset: 14px;
      border-radius: 22px;
      border: 1px solid rgba(255, 200, 240, 0.6);
      pointer-events: none;
      opacity: 0.6;
      transform: translateZ(20px);
    }

    .script-title {
      font-family: "Great Vibes", cursive;
      font-size: 36px;
      color: var(--accent-strong);
      margin-bottom: 8px;
      transform: translateZ(40px);
      text-shadow: 0 4px 10px rgba(200, 85, 166, 0.15);
      pointer-events: none;
    }

    .for {
      font-size: 12px;
      color: var(--text-soft);
      margin-bottom: 6px;
      letter-spacing: 0.18em;
      text-transform: uppercase;
      transform: translateZ(30px);
      pointer-events: none;
    }

    .name {
      font-size: 24px;
      letter-spacing: 0.22em;
      text-transform: uppercase;
      color: var(--accent-strong);
      position: relative;
      display: inline-block;
      transform: translateZ(50px);
      font-weight: 600;
      background: linear-gradient(45deg, var(--accent-strong), var(--accent-soft));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      opacity: 0;
      pointer-events: none;
    }

    .card.show-card .name {
      animation: nameBreath 2s ease-out 0.2s forwards;
    }

    @keyframes nameBreath {
      0% {
        transform: scale(0.88) translateZ(50px);
        opacity: 0;
      }

      100% {
        transform: scale(1) translateZ(50px);
        opacity: 1;
      }
    }

    /* تنسيق الفوانيس */
    .lantern {
      position: absolute;
      bottom: -50px;
      width: 20px;
      height: 30px;
      background: linear-gradient(to bottom, #fff7e6, #ffcc00, #ff9900);
      border-radius: 5px 5px 10px 10px;
      box-shadow: 0 0 15px rgba(255, 165, 0, 0.8), 0 0 30px rgba(255, 140, 0, 0.4);
      z-index: 999;
      opacity: 0.9;
      animation: floatUp linear forwards;
    }

    /* حركة صعود الفوانيس */
    @keyframes floatUp {
      0% {
        transform: translateY(0) scale(0.5) rotate(0deg);
        opacity: 0;
      }

      10% {
        opacity: 0.9;
      }

      100% {
        transform: translateY(-120vh) scale(1) rotate(10deg);
        opacity: 0;
      }
    }

    /* تأثير تعتيم الخلفية للتركيز على الفوانيس */
    body.night-mode {
      transition: background 2s ease;
      background: linear-gradient(to top, #0f0c29, #302b63, #24243e) !important;
    }

    /* تعديل النص النهائي ليكون متوهجاً */
    .final-wish-text {
      font-family: "Great Vibes", cursive;
      font-size: 32px;
      /* تكبير الخط */
      color: #fff !important;
      /* لون أبيض */
      text-shadow: 0 0 10px #ffcc00, 0 0 20px #ff9900;
      /* توهج ذهبي */
      animation: glowPulse 2s infinite alternate;
    }

    @keyframes glowPulse {
      from {
        text-shadow: 0 0 10px #ffcc00;
      }

      to {
        text-shadow: 0 0 20px #ffcc00, 0 0 30px #ff9900;
      }
    }

    .underline {
      width: 120px;
      height: 2px;
      margin: 20px auto 16px;
      background: linear-gradient(90deg,
          transparent,
          var(--accent-strong),
          transparent);
      opacity: 0.8;
      transform: translateZ(25px);
      pointer-events: none;
    }

    .tiny-note {
      font-size: 13px;
      color: var(--text-main);
      opacity: 0.9;
      white-space: pre-line;
      line-height: 1.8;
      max-width: 28em;
      margin: 10px auto 0;
      transform: translateZ(35px);
      min-height: 120px;
      pointer-events: none;
    }

    .wish-btn {
      position: absolute;
      bottom: 40px;
      left: 50%;
      transform: translateX(-50%) translateZ(100px);
      background: transparent;
      border: 1px solid var(--accent-strong);
      color: var(--accent-strong);
      padding: 12px 30px;
      border-radius: 50px;
      font-family: "Poppins", sans-serif;
      font-size: 15px;
      letter-spacing: 0.1em;
      text-transform: uppercase;
      z-index: 9999;
      cursor: pointer !important;
      opacity: 0;
      pointer-events: none;
      transition: opacity 3s ease,
        transform 3s cubic-bezier(0.2, 0.8, 0.2, 1),
        background 0.3s,
        color 0.3s;
    }

    .wish-btn.show-btn {
      opacity: 1;
      pointer-events: auto;
      transform: translateX(-50%) translateZ(100px);
    }

    .wish-btn:hover {
      background: var(--accent-strong);
      color: white;
      box-shadow: 0 0 25px rgba(200, 85, 166, 0.7);
      transform: translateX(-50%) translateZ(105px) scale(1.05);
    }

    canvas#fireworks {
      position: fixed;
      inset: 0;
      z-index: 1;
      pointer-events: none;
    }

    @media (max-width: 480px) {
      .card {
        height: auto;
        padding-bottom: 90px;
      }

      .wish-btn {
        bottom: 30px;
      }
    }
  </style>
</head>

<body>
  <!-- شلنا عناصر الكيرسر المخصص -->

  <div class="intro-fog"></div>
  <div class="intro-line"></div>

  <div class="floating-letters">
    <span>S</span>
    <span>H</span>
    <span>A</span>
    <span>H</span>
    <span>A</span>
    <span>D</span>
  </div>

  <canvas id="fireworks"></canvas>

  <div class="card-container" id="cardContainer">
    <div class="card" id="card">
      <div class="halo-ring"></div>

      <div class="script-title">Happy New Year</div>
      <div class="for">FOR</div>
      <div class="name">SHAHAD</div>
      <div class="underline"></div>
      <div class="tiny-note" id="typewriterText"></div>

      <button class="wish-btn" id="wishBtn" onclick="makeAWish()">Make a Wish ✨</button>
    </div>
  </div>

  <script>
    /* --- 2. Logic (الكتابة التدريجية + الزر) --- */
    const fullMessage = `Shahad, happy New Year.
    I wish you a year filled with peace and joy,
    and moments that place a gentle smile on your heart.
    May this new year be kinder and more beautiful for you,
    bringing everything you truly deserve…
    and may the days ahead carry a purity that reflects your spirit.`;

    const noteElement = document.getElementById('typewriterText');
    let charIndex = 0;

    function typeWriter() {
      const btn = document.getElementById('wishBtn');
      if (charIndex < fullMessage.length) {
        noteElement.textContent += fullMessage.charAt(charIndex);
        charIndex++;
        setTimeout(typeWriter, 35);
      } else {
        setTimeout(() => {
          btn.classList.add('show-btn');
        }, 300);
      }
    }

    window.addEventListener("load", () => {
      const card = document.getElementById("card");
      const wishBtn = document.getElementById("wishBtn");

      // fallback: لو صار أي شيء، الزر يطلع بعد 20 ثانية
      setTimeout(() => {
        wishBtn.classList.add("show-btn");
      }, 20000);

      setTimeout(() => {
        card.classList.add("show-card");
        setTimeout(typeWriter, 1200);
        setTimeout(() => { massiveBurst(); }, 400);
        // حذفنا كود ميلان الكارت (ماكو mousemove / rotate)
      }, 3300);
    });

    /* --- 3. Fireworks --- */
    const canvas = document.getElementById("fireworks");
    const ctx = canvas.getContext("2d");
    let w, h; let fireworks = [];
    function resize() { w = canvas.width = window.innerWidth; h = canvas.height = window.innerHeight; }
    window.addEventListener("resize", resize); resize();

    function randomPastel() {
      const c = ["rgba(255, 182, 193, A)", "rgba(255, 214, 230, A)", "rgba(209, 196, 233, A)", "rgba(187, 222, 251, A)", "rgba(255, 241, 189, A)", "rgba(200, 85, 166, A)"];
      return c[Math.floor(Math.random() * c.length)];
    }
    function createFirework() {
      const x = Math.random() * w; const y = Math.random() * (h * 0.6);
      const count = 40 + Math.random() * 30; const fw = [];
      for (let i = 0; i < count; i++) {
        const ang = Math.random() * Math.PI * 2; const spd = Math.random() * 3 + 1;
        fw.push({ x, y, vx: Math.cos(ang) * spd, vy: Math.sin(ang) * spd, life: 100 + Math.random() * 50, maxLife: 100, color: randomPastel(), size: Math.random() * 2 + 1 });
      }
      fireworks.push(fw);
    }
    setInterval(createFirework, 800);
    function draw() {
      ctx.clearRect(0, 0, w, h); ctx.globalCompositeOperation = "lighter";
      for (let i = fireworks.length - 1; i >= 0; i--) {
        const fw = fireworks[i]; let dead = 0;
        for (let j = fw.length - 1; j >= 0; j--) {
          const p = fw[j]; p.x += p.vx; p.y += p.vy; p.vy += 0.03; p.vx *= 0.99; p.life--;
          const a = Math.max(0, p.life / p.maxLife);
          if (p.life <= 0) { dead++; continue; }
          ctx.beginPath(); ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
          ctx.fillStyle = p.color.replace("A", a); ctx.fill();
        }
        if (dead === fw.length) fireworks.splice(i, 1);
      }
      requestAnimationFrame(draw);
    }
    draw();
    function massiveBurst() { for (let i = 0; i < 12; i++) setTimeout(() => createBurst(), i * 120); }
    function createBurst() {
      const x = Math.random() * w; const y = Math.random() * (h * 0.5);
      const count = 160 + Math.random() * 80; const fw = [];
      for (let i = 0; i < count; i++) {
        const ang = Math.random() * Math.PI * 2; const spd = Math.random() * 5 + 2;
        fw.push({ x, y, vx: Math.cos(ang) * spd, vy: Math.sin(ang) * spd, life: 130, maxLife: 130, color: randomPastel(), size: Math.random() * 2.2 + 1.5 });
      }
      fireworks.push(fw);
    }

    function makeAWish() {
      const btn = document.getElementById('wishBtn');
      const note = document.getElementById('typewriterText');

      btn.style.opacity = '0'; btn.style.pointerEvents = 'none';
      note.style.opacity = '0';

      setTimeout(() => {
        note.innerHTML = "May all your dreams<br>find their way to you this year.<br>✨";
        note.style.fontSize = "20px"; note.style.color = "#c855a6"; note.style.fontWeight = "600"; note.style.opacity = '1';
        launchFinale();
      }, 600);
    }
    function launchFinale() {
      let dur = 5000; let end = Date.now() + dur;
      (function frame() { for (let i = 0; i < 5; i++) createFirework(); if (Date.now() < end) requestAnimationFrame(frame); }());
    }
    /* --- دالة الأمنية الجديدة: إطلاق الفوانيس --- */
    function makeAWish() {
      const btn = document.getElementById('wishBtn');
      const note = document.getElementById('typewriterText');
      const card = document.getElementById('card');

      // 1. إخفاء الزر والنص القديم
      btn.style.opacity = '0';
      btn.style.pointerEvents = 'none';
      note.style.opacity = '0';

      // 2. تحويل الجو إلى "ليل" لتبرز الفوانيس
      document.body.classList.add('night-mode');

      // 3. تغيير النص للأمنية مع ستايل جديد
      setTimeout(() => {
        note.innerHTML = "May your year be as bright<br>as these lights...<br>Happy New Year ✨";
        note.classList.add('final-wish-text'); // إضافة الستايل المتوهج
        note.style.opacity = '1';

        // إطلاق سرب الفوانيس
        releaseLanterns();
      }, 800);
    }

    function releaseLanterns() {
      // عدد الفوانيس
      const lanternCount = 50;

      for (let i = 0; i < lanternCount; i++) {
        setTimeout(() => {
          createLantern();
        }, i * 150); // إطلاق واحد كل 150 ملي ثانية
      }
    }

    function createLantern() {
      const lantern = document.createElement('div');
      lantern.classList.add('lantern');

      // موقع عشوائي في العرض
      const xPos = Math.random() * window.innerWidth;
      lantern.style.left = `${xPos}px`;

      // حجم عشوائي لإعطاء عمق
      const scale = 0.5 + Math.random() * 0.8;
      lantern.style.transform = `scale(${scale})`;

      // سرعة عشوائية
      const duration = 6 + Math.random() * 5; // بين 6 و 11 ثانية
      lantern.style.animationDuration = `${duration}s`;

      document.body.appendChild(lantern);

      // حذف الفانوس بعد انتهاء الانيميشن لتنظيف الذاكرة
      setTimeout(() => {
        lantern.remove();
      }, duration * 1000);
    }
  </script>
</body>

</html>